<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      background-color: #eee;
      text-align: center;
    }
		canvas {
			float: left;
			margin: 10px 10px; 
		}

  </style>
</head>
<body>
	<canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas>	
	<canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas><canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas><canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas><canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas><canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas>
<canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas>
<canvas class="myCanvas" height="210" width="210" style="border:1px solid #d3d3d3;">
	Your browser does not support the HTML5 canvas tag.
	</canvas>

	<script>
		let shapes = [[3, 5, 1, 4, 2, 6, 7, 9, 8],
								[1, 5, 1, 5, 6, 6, 7, 9, 8],
								[7, 9, 8],
								[1, 5, 1, 6],
								[5, 1, 5, 6, 4, 9, 3, 7, 8, 2, 5],
								[4, 1, 3, 4, 9, 5, 6, 7, 4, 8],
								[1, 3, 4, 6, 7, 9],
								[4, 2, 8, 7, 3, 9, 1]];

		let ctxs = []
		function initContext() {
			let contexts = document.getElementsByClassName("myCanvas");
			for (let i = 0; i < contexts.length; i++) {
				let ctx = contexts[i].getContext("2d");
				ctx.strokeStyle = '#666fff';
				ctx.lineWidth = 4;
				ctx.lineCap="round";
				ctx.lineJoin="round";
				ctx.globalAlpha=0.8;
				ctxs.push(ctx)
			}
		}

		function draw(shape, ctx) {
		  let a = {1:[0, 0], 2:[1, 0], 3:[2, 0], 4:[0, 1], 5:[1, 1], 6:[2, 1], 7:[0, 2], 8:[1, 2], 9:[2, 2]}
			let flag = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];
			let i = 0;
			let stop = 0;

	  	let relPos = (pos) => {
	  		let baseH = baseW = 35;
	  		return [pos[0] * 70 + baseW, pos[1] * 70 + baseH];
	  	}

			for (let i = 1; i <= 9; i++) {
				ctx.beginPath();ctx.arc(relPos(a[i])[0], relPos(a[i])[1], 6, 0, 2 * Math.PI);ctx.stroke();
			}

			let midPoint = (pre, next) => {
				if ((pre[0]+next[0]) % 2 == 0 && (pre[1]+next[1]) % 2 == 0) {
					let mx = (pre[0]+next[0]) / 2;
					let my = (pre[1]+next[1]) / 2;
					return [mx, my];
				}

				return [];
			}

			let line = () => {
		  	if (i >= shape.length - 1) {
		  		window.clearInterval(stop)
		  		return;
		  	}
		  	
				let p = a[shape[i]]; 
		  	let np = a[shape[i + 1]];

		  	while (flag[np]) {
					i++;
					if (i >= shape.length - 1) {
						window.clearInterval(stop)
		  			return;
					}
					np = a[shape[i + 1]];
				}

				let mid = midPoint(p, np)
				if (mid.length > 0) {
						flag[mid] = 1;
				}

				ctx.beginPath();
				ctx.moveTo(relPos(p)[0], relPos(p)[1]);
				ctx.lineTo(relPos(np)[0], relPos(np)[1]);
				ctx.stroke();
				flag[p] = 1;
				i++;
			}
			stop = setInterval(line, 500);  
		}

		initContext()
		// var i = 0
		// let drawS = () => {
		// 	setInterval(draw(shapes[i], ctxs[i]), 1000)
		// 	i++
		// 	if (i == ctxs.length) {
		// 		return
		// 	}
		// }
		// drawS()
		for (let i=0;i<ctxs.length; i++) {
			draw(shapes[i], ctxs[i])
			// setInterval(), 1000);  
		}
	</script> 
</body>
</html>

<!--
1. 重构代码到面向对象
2. 扩展矩阵的个数，不止3*3
3. 计算随机h生成的一串数字
 -->
